# Diploma
## Зависимости
* Docker. [Установка](https://docs.google.com/presentation/d/1yGKtsHyUtIIPKTCl6uX8gAWbbg8GP3wHRRTO5XufZsM/edit?slide=id.g9a43d8b6c4_0_31#slide=id.g9a43d8b6c4_0_31)
* Python. Библиотеки: [osmiter(1.3.1)](https://pypi.org/project/osmiter/), [neo4j(5.28.1) ](https://pypi.org/project/neo4j/)
## Запуск
### Запуск neo4j с помощью docker: 
docker run -p 7474:7474 -p 7687:7687 --env NEO4J_AUTH="none" neo4j:5.26
<p>Web-интерфейс: http://localhost:7474/
<p>Логин: neo4j </p>
<p>Пароль: password</p>
  
### Запуск программы:
python3 main.py
## Что сделано
Изначально я планировал в качестве примера использовать Калининградскую область, но столкнулся с некоторыми трудностями(большое количество вершин(порядка 2 млн 800 тыс), непонятно,что делать с вершинами,которые не являются частями дорог и т.д.),поэтому я создал собственный граф из 7-ми вершин,7 дорог и 3 маршрутов общественного транспорта)
Файл с "картой" сделан в формате OpenStreetMap с некоторыми измененями. На данный момент программа способна считывать этот файл и загружать его в графовую базу данных,т.е. "строить" граф(узлы=вершины,дуги=пути и отношения(отношения в OpenStreetMap задают маршруты общественного транспорта)).

Визуализация из базы данных: ![изображение](https://github.com/user-attachments/assets/0464ca16-1a31-44f2-a06f-9d953e0d80b9)



Вершина задаётся индексом,координатами(широта,долгота) и набором тегов(если в вершине расположен,например,магазин,то она содержит соответствующий тег("shop")). Рёбра содержат свойства(например цена проезда)
Непосредственно текст ВКР пока отсутствует, но в осеннем семестре у нас был курс про написание научных статей, результатом которого стала работа,лежащая в репозитории("Статья"). Планирую использовать её как наработку к написанию текста
## Что планирую сделать в ближайшее время
* Доработать обработку файла
* Добавить вершинам и рёбрам информацию(наделить вершины тегами,(кемпинги,глэмпинги и т.д., в соответствии с тегами OSM). Возможно изменить граф,добавив вершин,дорог и общественного транспорта или изменив их
* Написать непосредственно алгоритмы для нахождения кратчайшего пути и решения задачи коммивояжёра(склоняюсь к решению динамическим программированием)
* Систему рекомендаций на основании тегов в выбранных точках интереса
* К сожалению,полноценный интерфейс реализовать не смогу. Скорее всего "выбирать" точки интереса пользователю придётся "вручную" изменяя теги вершин в файле карты
* Не позднее 09.05 начать писать сам текст ВКР

# Обновление(13:00 11.05.25)
* Был изменён граф
  ![изображение](https://github.com/user-attachments/assets/1777e9e1-f3d8-430f-975a-be6ece9c49f9)
  
  Жирным выделены маршруты общественного транспорта(тонким-дороги,по которым можно проехать на машине). На каждой дуге подписано расстояние(для упрощения,вычисляется как корень из суммы квадратов разности координат точек) 
  
  ## Описание узлов:
  
  1 Кемпинг. Комфорт:4. Окружение:лес
  
  2 Ничего/Перекресток. Комфорт:0. Окружение:лес
  
  3 Особо Охраняемая Природная Территория(ООПТ). Комфорт:2. Окружение:лес. Название:Сумеречный лес

  4 Город. Комфорт:10. Окружение:море. Название:Буян

  5 Город. Комфорт:10. Окружение:море/поле(Я не смог найти способ хранить сразу несколько свойств окружения,поэтому в графе хранится только "море"). Название:Мидгард. Я планирую использовать этот город как начальную(домашнюю) и, соответственно,конечную точку для построения маршрута

  6 Городок. Комфорт:8. Окружение:поле. Название:Калевала.

  7 ООПТ. Комфорт:2. Окружение:болото. Название: Синие топи

  8 Ничего/Перекресток. Комфорт:0. Окружение:поле

  9 Город. Комфорт:10. Окружение:поле. Название:Китеж

  10 Глэмпинг. Комфорт:6. Окружение:лес

  Также нужно сказать,что ребро "35"(связывает узлы 3 и 5) является зимником,т.е. существует только в зимнее время

  ## Описание маршрутов
  Каждый маршрут двунаправлен
  
  * Маршрут "45". Является паромной переправой(работает только в летнее время). Связывает узлы 4 и 5. Скорость:10. Цена:100. Комфорт:2
  * Маршрут "4125". Автобус,проходящий через узлы 4,1,2,5. Скорость:20. Цена:30. Комфорт:8
  * Маршрут "569". Автобус,проходящий через узлы 5,6,9. Скорость:20. Цена:30. Комфорт:8
  * Маршрут "587". Автобус,проходящий через узлы 587. Скорость:20. Цена:30. Комфорт:8
  ## Изменения в программе
  * Доработал программу, чтоб она могла обрабатывать граф выше
  * Сделал заготовку для создания матрицы смежности("make_graph"). В данный момент программа получает из базы данных все возможные дуги(линии для автомобиля и отношения для общественного транспорта) и просто добавляет/заменяет дуги в матрице смежности,без учёта критериев(наличие автомобиля,время года,наличие детей и что,собственно,минимизировать)
  ## Планирую сделать в ближайшее время
  * Изменить создание графа, добавив учёт критериев
  * Запрограммировать алгоритм Флойда(для нахождения кратчайшего пути между всеми парами вершин)
  * Реализовать само решение задачи коммивояжёра с восстановлением пути
  * Начал работу над текстом ВКР. Планирую к 12:00 12.05 иметь почти готовый вариант и прислать его Вам
